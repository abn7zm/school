<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©</title>

<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}

body{
  font-family:Tajawal,sans-serif;
  background:#eceeef; /* Ø£ØºÙ…Ù‚ Ø´ÙˆÙŠ */
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#333
}

.center-box{
  background:#fff;
  width:100%;
  max-width:480px; /* Ø£ÙƒØ¨Ø± */
  padding:44px 40px;
  border-radius:18px;
  border:1px solid #e2e2e2;
  box-shadow:0 12px 30px rgba(0,0,0,.08)
}

h2{
  text-align:center;
  font-size:22px;
  margin:0 0 8px;
  font-weight:600;
  color:#333
}

.subtitle{
  text-align:center;
  font-size:14px;
  color:#777;
  margin-bottom:30px
}

input{
  width:100%;
  padding:15px;
  margin-top:16px;
  font-size:15px;
  border-radius:12px;
  border:1px solid #dcdcdc;
  background:#fafafa;
  transition:.2s
}

input:focus{
  outline:none;
  background:#fff;
  border-color:#005d7e
}

button{
  margin-top:32px;
  width:100%;
  padding:16px;
  border:none;
  border-radius:30px;
  background:#005d7e; /* Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ø³Ø§Ø¨Ù‚ */
  color:#fff;
  font-size:17px;
  cursor:pointer;
  transition:.25s
}

button:hover{
  background:#00445c
}

.success{
  display:none;
  margin-top:24px;
  padding:14px;
  border-radius:12px;
  background:#f0f7f2;
  color:#2f6b3f;
  text-align:center;
  font-size:15px
}

.error{
  display:none;
  margin-top:24px;
  padding:14px;
  border-radius:12px;
  background:#fbf1f1;
  color:#9c2f2f;
  text-align:center;
  font-size:15px
}

.timer{
  margin-top:8px;
  font-size:13px;
  color:#666
}
</style>
</head>

<body>

<div class="center-box">
  <h2>ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©</h2>
  <div class="subtitle">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø© ÙˆØªØ£ÙƒÙŠØ¯Ù‡Ø§</div>

  <input id="pass1" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©">
  <input id="pass2" type="password" placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">

  <button onclick="reset()">Ø­ÙØ¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>

  <div class="success" id="ok">
    ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­ âœ”
    <div class="timer" id="countdown"></div>
  </div>

  <div class="error" id="err"></div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyud8NS18rOn7W1YngyRv4cuCFjvnBMQi-gwH_tUsfzIZpKcOENZ6ekH_wINN4wSu-78Q/exec";
const token = new URLSearchParams(location.search).get("token");

async function reset(){
  err.style.display="none";

  if(pass1.value !== pass2.value){
    err.textContent="ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†";
    err.style.display="block";
    return;
  }

  const data = new URLSearchParams();
  data.append("action","resetPassword");
  data.append("token",token);
  data.append("newpass",pass1.value);

  const res = await fetch(SCRIPT_URL,{method:"POST",body:data});
  const t = await res.text();

  if(t === "done"){
    ok.style.display="block";

    let s = 5;
    countdown.textContent = `Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ùƒ Ø®Ù„Ø§Ù„ ${s} Ø«ÙˆØ§Ù†ÙŠ`;

    const i = setInterval(()=>{
      s--;
      countdown.textContent = `Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ùƒ Ø®Ù„Ø§Ù„ ${s} Ø«ÙˆØ§Ù†ÙŠ`;
      if(s === 0){
        clearInterval(i);
        location.href = "index.html";
      }
    },1000);

  }else{
    err.textContent="Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ Ù…Ù†ØªÙ‡ÙŠ";
    err.style.display="block";
  }
}
document.addEventListener('keydown', function(e) {
    // F12
    if(e.key === 'F12') e.preventDefault();
    // Ctrl+Shift+I / Ctrl+Shift+J / Ctrl+Shift+C
    if(e.ctrlKey && e.shiftKey && ['I','J','C'].includes(e.key)) e.preventDefault();
    // Ctrl+U (Ø¹Ø±Ø¶ Ù…ØµØ¯Ø± Ø§Ù„ØµÙØ­Ø©)
    if(e.ctrlKey && e.key === 'u') e.preventDefault();
    // Ctrl+S (Ø­ÙØ¸ Ø§Ù„ØµÙØ­Ø©)
    if(e.ctrlKey && e.key === 's') e.preventDefault();
    // Ctrl+Shift+S
    if(e.ctrlKey && e.shiftKey && e.key === 'S') e.preventDefault();
});

// ======== Ù…Ù†Ø¹ ÙƒÙ„ÙŠÙƒ ÙŠÙ…ÙŠÙ† ========
document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
});

// ======== Ù…Ø­Ø§ÙˆÙ„Ø© ÙƒØ´Ù DevTools Ø§Ù„Ù…ÙØªÙˆØ­ ========
let devtools = { open: false };
const threshold = 160; // Ø§Ø±ØªÙØ§Ø¹/Ø¹Ø±Ø¶ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
setInterval(() => {
    const widthThreshold = window.outerWidth - window.innerWidth > threshold;
    const heightThreshold = window.outerHeight - window.innerHeight > threshold;
    devtools.open = widthThreshold || heightThreshold;
    if(devtools.open) {
        alert("ğŸš« ØªÙ… ÙƒØ´Ù Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·ÙˆØ±!");
        // ÙŠÙ…ÙƒÙ† Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØµÙØ­Ø© Ø£Ùˆ ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
        window.location.href = "about:blank";
    }
}, 500);

// ======== Ù…Ù†Ø¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… console ========
(function() {
    const originalConsole = console.log;
    console.log = function() {
        alert("ğŸš« Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… console!");
        return originalConsole.apply(console, arguments);
    }
})();

// ======== ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù†Ø§ÙØ°Ø© Ù„Ø¥Ø±Ø¨Ø§Ùƒ DevTools ========
setInterval(() => {
    if(devtools.open){
        window.resizeTo(100,100); // ÙŠØµØºØ± Ø§Ù„Ù†Ø§ÙØ°Ø© Ù„Ùˆ DevTools Ù…ÙØªÙˆØ­
    }
}, 1000);
</script>

</body>
</html>
