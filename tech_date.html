<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ØµÙØ­Ø© Ø§Ù„ØªÙ‚ÙˆÙŠÙ…</title>
  <link rel="icon" href="https://i.imghippo.com/files/iJhm9520ofU.png" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, #e0f7fa, #ffffff);
      color: #333;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .header {
      position: relative;
      background: #005d7e;
      padding: 50px;
      color: white;
    }

    .logo {
      position: absolute;
      top: 10px;
      left: 20px;
      width: 100px;
      filter: drop-shadow(0 0 10px rgba(0, 230, 246, 0.6));
    }

    .return {
      position: absolute;
      top: 20px;
      right: 20px;
      background-color: #f6b100;
      color: #ffffff;
      padding: 10px 20px;
      border-radius: 25px;
      font-weight: bold;
      font-size: 16px;
      display: flex;
      align-items: center;
      text-decoration: none;
      transition: all 0.3s;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .return:hover {
      background-color: #c99000;
      transform: scale(1.05);
    }

    .return img {
      margin-left: 10px;
      width: 20px;
    }

    .calendar-container {
      width: 90%;
      max-width: 1200px;
      margin: 50px auto;
      background-color: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      text-align: center;
      flex-grow: 1;
    }

    .month {
      font-size: 32px;
      color: #007a8c;
      margin-bottom: 20px;
      font-weight: bold;
    }

    .navigation {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
    }

    .navigation button {
      background-color: #009db2;
      color: white;
      border: none;
      padding: 10px 25px;
      cursor: pointer;
      font-size: 18px;
      border-radius: 25px;
      transition: 0.3s;
    }

    .navigation button:hover {
      background-color: #007a8c;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 15px;
    }

    .day {
      background-color: #f4f4f4;
      border-radius: 15px;
      padding: 10px;
      position: relative;
      min-height: 100px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      transition: 0.3s;
    }

    .day:hover {
      transform: scale(1.03);
      background-color: #e0f7fa;
    }

    .day-number {
      position: absolute;
      top: 10px;
      right: 15px;
      font-weight: bold;
    }

    .current-day {
      background-color: #009db2 !important;
      color: white;
    }

    .events {
      margin-top: 35px;
      font-size: 14px;
      color: #333;
    }
.footer {
      background-color: #005d7e;
      color: #ffffff;
      padding: 25px 40px;
      width: 100%;
      text-align: right;
      margin-top: auto;
      box-sizing: border-box;
    }

    .footer h3 {
      margin-bottom: 15px;
      font-size: 22px;
      color: #ffffff;
      font-weight: bold;
      border-bottom: 2px solid #f6b100;
      padding-bottom: 5px;
    }

    .contact-list {
      list-style: none;
      padding: 0;
      margin: 0 0 20px 0;
      font-size: 18px;
    }

    .contact-list li {
      margin-bottom: 10px;
    }

    .contact-list li a {
      color: #ffffff;
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .contact-list li a:hover {
      color: #007a8c;
      text-decoration: underline;
    }

    .end {
      text-align: center;
      color: #ffffff;
      font-size: 14px;
      margin-top: 15px;
    }

    a {
      text-decoration: none;
    }

    @media screen and (max-width: 768px) {
      .calendar {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media screen and (max-width: 480px) {
      .calendar {
        grid-template-columns: repeat(2, 1fr);
      }
    }



    #loadingOverlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.9);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.loader-box {
  text-align: center;
  font-size: 18px;
  color: #005d7e;
  font-weight: bold;
}

.spinner {
  width: 50px;
  height: 50px;
  border: 5px solid #e0e0e0;
  border-top: 5px solid #009db2;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 15px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

  </style>
</head>
<body>
  <div class="header">
    <img src="https://i.postimg.cc/Y0YGqTrW/logo1.png" alt="Logo" class="logo">
    <a href="tech_home.html" class="return">
      Ø¹ÙˆØ¯Ø©
      <img src="https://i.postimg.cc/wMQTD7Ds/arrow.png" alt="Arrow">
    </a>
  </div>

<div id="loadingOverlay">
  <div class="loader-box">
    <div class="spinner"></div>
    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…...</p>
  </div>
</div>



  <div class="calendar-container">

        <div style="margin-bottom:20px;text-align:right">
      <button onclick="openAddEvent()" style="background:#28a745;color:#fff;padding:10px 20px;border:none;border-radius:10px;font-size:16px;cursor:pointer">
    â• Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø«
  </button>
</div>

<table id="eventsTable" style="width:100%;border-collapse:collapse;margin-bottom:20px">
  <thead>
    <tr style="background:#009db2;color:white">
      <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
      <th>Ø§Ù„Ø­Ø¯Ø«</th>
      <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>


    <div class="month" id="month"></div>
    <div class="navigation">
      <button onclick="prevMonth()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button onclick="nextMonth()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
    <div class="calendar" id="calendar"></div>



  </div>

  
  <div class="footer">
    <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</h3>
    <ul class="contact-list">
      <li>ğŸ“ <a href="tel:+966536382599">+966 536382599</a></li>
      <li>ğŸ“§ <a href="mailto:abn7zm@gmail.com">abn7zm@gmail.com</a></li>
      <li>ğŸ« Ù…Ø¬Ù…Ø¹ Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ø¨Ù† Ø­Ø²Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ, ØªØ¨ÙˆÙƒ</li>
    </ul>
    <p class="end">Â©2023-<span id="year"></span> Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ø§Ù„ÙÙƒØ±ÙŠØ© ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ© Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø§Ø³Ù… Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ø¨Ù† Ø­Ø²Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</p>
  </div>



<div id="eventModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5)">
  <div style="background:#fff;width:90%;max-width:400px;margin:10% auto;padding:20px;border-radius:15px;text-align:right">
    
    <h3 id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø«</h3>

    <input type="date" id="eventDate" style="width:100%;padding:10px;margin-bottom:10px">
    <input type="text" id="eventTitle" placeholder="Ø§Ø³Ù… Ø§Ù„Ø­Ø¯Ø«" style="width:100%;padding:10px;margin-bottom:10px">

    <input type="hidden" id="eventId">

    <button onclick="saveEvent()" style="background:#009db2;color:#fff;padding:10px 20px;border:none;border-radius:10px">
      Ø­ÙØ¸
    </button>

    <button onclick="closeModal()" style="background:#ccc;padding:10px 20px;border:none;border-radius:10px">
      Ø¥Ù„ØºØ§Ø¡
    </button>

  </div>
</div>




  <script>
   const today = new Date();
let currentMonth = today.getMonth();
let currentYear = today.getFullYear();

    const months = ["ÙŠÙ†Ø§ÙŠØ±", "ÙØ¨Ø±Ø§ÙŠØ±", "Ù…Ø§Ø±Ø³", "Ø£Ø¨Ø±ÙŠÙ„", "Ù…Ø§ÙŠÙˆ", "ÙŠÙˆÙ†ÙŠÙˆ", "ÙŠÙˆÙ„ÙŠÙˆ", "Ø£ØºØ³Ø·Ø³", "Ø³Ø¨ØªÙ…Ø¨Ø±", "Ø£ÙƒØªÙˆØ¨Ø±", "Ù†ÙˆÙÙ…Ø¨Ø±", "Ø¯ÙŠØ³Ù…Ø¨Ø±"];
    const currentDay = today.getDate();





    function renderCalendar() {
      const calendar = document.getElementById('calendar');
      const monthElement = document.getElementById('month');
      const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

      monthElement.textContent =
  months[currentMonth] + " " + currentYear +
  (currentMonth === today.getMonth() && currentYear === today.getFullYear()
    ? " (Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ)"
    : "");

      calendar.innerHTML = '';

      for (let day = 1; day <= daysInMonth; day++) {
        const dayElement = document.createElement('div');
        dayElement.className = 'day';

        if (currentMonth === today.getMonth() && day === currentDay) {
          dayElement.classList.add('current-day');
        }

        dayElement.innerHTML = `<span class="day-number">${day}</span>`;

        const eventKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        if (events[eventKey]) {
          const eventList = document.createElement('div');
          eventList.className = 'events';
          events[eventKey].forEach(event => {
            const eventItem = document.createElement('div');
            eventItem.textContent = event;
            eventList.appendChild(eventItem);
          });
          dayElement.appendChild(eventList);
        }

        calendar.appendChild(dayElement);
      }
    }

    function prevMonth() {
  if (currentMonth === 0) {
    currentMonth = 11;
    currentYear--;
  } else {
    currentMonth--;
  }
  renderCalendar();
}

function nextMonth() {
  if (currentMonth === 11) {
    currentMonth = 0;
    currentYear++;
  } else {
    currentMonth++;
  }
  renderCalendar();
}



    document.getElementById("year").textContent = new Date().getFullYear();









    let sheetEvents = [];
    let events = {};

const API_URL = "https://script.google.com/macros/s/AKfycbxB_rIAVzV5PN0xbnXtBg69KmvEbpssFK5lL4AzetsBtQVU9l3PtZk3O9bmy1cosTPw/exec";

function openAddEvent(){
  document.getElementById("eventId").value = "";
  document.getElementById("eventDate").value = "";
  document.getElementById("eventTitle").value = "";
  document.getElementById("modalTitle").textContent = "Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø«";
  document.getElementById("eventModal").style.display = "block";
}

function closeModal(){
  document.getElementById("eventModal").style.display = "none";
}

async function saveEvent(){
  const id = document.getElementById("eventId").value;
  const date = document.getElementById("eventDate").value;
  const title = document.getElementById("eventTitle").value;

  if(!date || !title){
    alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
    return;
  }

  await fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      action: id ? "edit" : "add",
      id,
      date,
      title
    })
  });

  closeModal();
  loadEvents();
}

async function loadEvents(){
  showLoading();

  const res = await fetch(API_URL);
  sheetEvents = await res.json();

  renderTable();
  renderCalendarFromSheet();

  hideLoading();
}


function renderTable(){
  const tbody = document.querySelector("#eventsTable tbody");
  tbody.innerHTML = "";

  sheetEvents.forEach(ev=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${formatDate(ev.date)}</td>

      <td>${ev.title}</td>
      <td>
        <button onclick="editEvent('${ev.id}')" style="background:#f6b100;border:none;padding:5px 10px">âœï¸</button>
        <button onclick="deleteEvent('${ev.id}')" style="background:#dc3545;color:white;border:none;padding:5px 10px">ğŸ—‘</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function editEvent(id){
  const ev = sheetEvents.find(e=>e.id==id);
  document.getElementById("eventId").value = ev.id;
  document.getElementById("eventDate").value = ev.date;
  document.getElementById("eventTitle").value = ev.title;
  document.getElementById("modalTitle").textContent = "ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¯Ø«";
  document.getElementById("eventModal").style.display = "block";
}

async function deleteEvent(id){
  if(!confirm("Ø­Ø°Ù Ø§Ù„Ø­Ø¯Ø«ØŸ")) return;

  await fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      action:"delete",
      id
    })
  });

  loadEvents();
}

function renderCalendarFromSheet(){
  Object.keys(events).forEach(k=>delete events[k]);

  sheetEvents.forEach(ev=>{
    if(!events[ev.date]) events[ev.date]=[];
    events[ev.date].push(ev.title);
  });

  renderCalendar();
}

window.onload = () => {
  loadEvents();
};



function formatDate(dateValue) {
  const d = new Date(dateValue);

  return (
    d.getFullYear() + "-" +
    String(d.getMonth() + 1).padStart(2, "0") + "-" +
    String(d.getDate()).padStart(2, "0")
  );
}
function showLoading() {
  document.getElementById("loadingOverlay").style.display = "flex";
}

function hideLoading() {
  document.getElementById("loadingOverlay").style.display = "none";
}

  </script>
</body>
</html>
